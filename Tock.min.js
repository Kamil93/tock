function Tock(options){this.interval=options.interval||10;this.type=options.type||'timer';if(options.callback!=undefined){this.callback=options.callback;}else{this.callback=function(){};}
this.go=false;this.countdown_start=0;}
Tock.prototype.tick=function(){this.time+=this.interval;this.elapsed=Math.floor(this.time/this.interval)/10;if(Math.round(this.elapsed)==this.elapsed){this.elapsed+='.0';}
var diff=(Date.now()-this.start_time)-this.time;var t=this;if(this.callback!=undefined){this.callback(this);}
if(this.go){this.timeout=setTimeout(function(){t.tick();},(this.interval-diff));}};Tock.prototype.tickDown=function(){console.log('tickdown');this.time-=this.interval;this.elapsed=Math.floor(this.time/this.interval)/10;if(Math.round(this.elapsed)==this.elapsed){this.elapsed+='.0';}
var diff=(Date.now()-this.start_time)-this.time;var t=this;if(this.callback!=undefined){this.callback(this);}
if(this.go){this.timeout=setTimeout(function(){t.tickDown();},(this.interval-diff));}};Tock.prototype.reset=function(){this.stop();this.start_time=0;this.time=0;this.elapsed='0.0';};Tock.prototype._startCountdown=function(start){var time_split=start.split(':');var duration_ms=start[0]*1000;if(start.length){duration_ms+=start[1]*60000;}
console.log(duration_ms);this.start_time=Date.now();this.end_time=this.start_time+start;this.time=0;this.elapsed='0.0';this.go=true;var t=this;this.timeout=setTimeout(function(){t.tickDown();},100);};Tock.prototype._startTimer=function(){this.start_time=Date.now();this.time=0;this.elapsed='0.0';this.go=true;var t=this;this.timeout=setTimeout(function(){t.tick();},100);};Tock.prototype.start=function(start){if(this.type=='countdown'){this._startCountdown(start);}else{this._startTimer();}};Tock.prototype.stop=function(){this.go=false;this.final_time=(Date.now()-this.start_time);clearTimeout(this.timeout);};Tock.prototype.lap=function(){var now=(Date.now()-this.start_time);if(this.go){return now;}
if(this.final_time!=undefined){return this.final_time;}else{return'';}};Tock.prototype.msToTime=function(ms){var milliseconds=ms%1000,seconds=Math.floor((ms/1000)%60).toString(),minutes=Math.floor((ms/(60*1000))%60).toString();if(seconds.length==1){seconds='0'+seconds}
if(minutes.length==1){minutes='0'+minutes}
return minutes+":"+seconds+":"+milliseconds;};